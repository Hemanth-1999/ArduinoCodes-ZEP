#include <AESLib.h>

byte key[16] = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F};

void setup() {
  Serial.begin(9600);
}

void loop() {
  byte encryptedData[] = {
  0x7B, 0x22, 0x74, 0x78, 0x63, 0x63, 0x5F, 0x65, 0x73, 0x22, 0x3A, 0x7B, 0x22, 0x41, 0x54, 0x22,
  0x15, 0x24, 0x08, 0x3A, 0x37, 0x37, 0x2C, 0x22, 0x52, 0x48, 0x22, 0x3A, 0x32, 0x30, 0x2C, 0x22,
  0x42, 0x50, 0x22, 0x3A, 0x36, 0x30, 0x2C, 0x22, 0x53, 0x4C, 0x22, 0x3A, 0x32, 0x32, 0x2C, 0x22,
  0x56, 0x50, 0x44, 0x22, 0x3A, 0x32, 0x36, 0x2C, 0x22, 0x44, 0x50, 0x22, 0x3A, 0x38, 0x32, 0x2C,
  0x22, 0x45, 0x54, 0x22, 0x3A, 0x32, 0x35, 0x7D, 0x7D, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

  // Calculate the data length by dividing the size of the array by the size of a single element
  int dataLength = sizeof(encryptedData) / sizeof(encryptedData[0]);

  byte decryptedData[dataLength];

  AES aesDecryptor;

  // Set the AES decryption key
  aesDecryptor.set_key(key, sizeof(key));

  // Perform decryption (without IV for ECB mode)
  aesDecryptor.decrypt(encryptedData, decryptedData);

  // Print the decrypted data
  Serial.println("Decrypted Data:");
  for (int i = 0; i < dataLength; i++) {
    Serial.print(decryptedData[i], HEX);
    Serial.print(" ");
  }
  Serial.println();

  // Wait for a moment before decrypting again
  delay(5000);
}
